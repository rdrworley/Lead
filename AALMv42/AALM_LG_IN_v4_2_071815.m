%--------------------------------------------------------------------
%
% File: AALM_LG_IN.m
%
% Created by Gary Diamond, SRC Inc, 07/18/15
%
%This run time file:
%	Reads inputs from INPUTDATA.DATA derived from AALM-LG INPUT&OUTPUT.xlsm
%	Populates TABLE variables in AALM_LG.csl; e.g., CAIR=[CAIRDATA(2:51,10),CAIRDATA(2:51,3)]
%	Sets constants in AALM_lg.csl; e.g., CAIRBASE=AIRPULSEDATA(1,2
% --------------------------------------------------------------------

load @file=AALM_LG_INPUTDATA @format=ascii 

INPUTDATA=AALM_LG_INPUTDATA;

%Simulation parameters
SIMDATA=INPUTDATA (2:11, 2:21);

%End day of simulation (d)
TSTOP=SIMDATA(1,1);

%Communication interval (d)	
CINT=SIMDATA(2,1);	

%Data files

%Air data files
CAIRDATA=INPUTDATA(13:63, 2:21);
AIRPULSEDATA=INPUTDATA(65:84,2:21);
VENTDATA=INPUTDATA(86:136,2:21);

%Air data arrays
CAIR=[CAIRDATA(2:51,10),CAIRDATA(2:51,3)];
VENT=[VENTDATA(1:50,4),VENTDATA(1:50,3)];
CAIRBASE=AIRPULSEDATA(1,2);
CAIRPULSE=AIRPULSEDATA(2,2);
FAIRPULSE=AIRPULSEDATA(3,2);
AIRSTART=AIRPULSEDATA(4,2);
AIRSTOP=AIRPULSEDATA(5,2);
AIRWID1=AIRPULSEDATA(6,2);
AIRPER1=AIRPULSEDATA(7,2);
AIRWID2=AIRPULSEDATA(8,2);
AIRPER2=AIRPULSEDATA(9,2);

%Dust data files
CDUSTDATA=INPUTDATA(138:188,2:21);
DUSTPULSEDATA=INPUTDATA(190:209,2:21);
IRDUSTDATA=INPUTDATA(211:261,2:21);

%Dust data arrays
CDUST=[CDUSTDATA(2:51,10),CDUSTDATA(2:51,3)];
IRDUST=[IRDUSTDATA(1:50,4),IRDUSTDATA(1:50,3)];
CDUSTBASE=DUSTPULSEDATA(1,2);
CDUSTPULSE=DUSTPULSEDATA(2,2);
FDUSTPULSE=DUSTPULSEDATA(3,2);
DUSTSTART=DUSTPULSEDATA(4,2);
DUSTSTOP=DUSTPULSEDATA(5,2);
DUSTWID1=DUSTPULSEDATA(6,2);
DUSTPER1=DUSTPULSEDATA(7,2);
DUSTWID2=DUSTPULSEDATA(8,2);
DUSTPER2=DUSTPULSEDATA(9,2);

%Water data files
CWATERDATA=INPUTDATA(263:313,2:21);
WATERPULSEDATA=INPUTDATA(315:334,2:21);
IRWATERDATA=INPUTDATA(336:386,2:21);

%Water data arrays
CWATER=[CWATERDATA(2:51,10),CWATERDATA(2:51,3)];
IRWATER=[IRWATERDATA(1:50,4),IRWATERDATA(1:50,3)];
CWATERBASE=WATERPULSEDATA(1,2);
CWATERPULSE=WATERPULSEDATA(2,2);
FWATERPULSE=WATERPULSEDATA(3,2);
WATERSTART=WATERPULSEDATA(4,2);
WATERSTOP=WATERPULSEDATA(5,2);
WATERWID1=WATERPULSEDATA(6,2);
WATERPER1=WATERPULSEDATA(7,2);
WATERWID2=WATERPULSEDATA(8,2);
WATERPER2=WATERPULSEDATA(9,2);

%Food data files
INFOODDATA=INPUTDATA(388:438,2:21);
FOODPULSEDATA=INPUTDATA(440:459,2:21);

%Food data arrays
INFOOD=[INFOODDATA(2:51,7),INFOODDATA(2:51,3)];
INFOODBASE=FOODPULSEDATA(1,2);
INFOODPULSE=FOODPULSEDATA(2,2);
FFOODPULSE=FOODPULSEDATA(3,2);
FOODSTART=FOODPULSEDATA(4,2);
FOODSTOP=FOODPULSEDATA(5,2);
FOODWID1=FOODPULSEDATA(6,2);
FOODPER1=FOODPULSEDATA(7,2);
FOODWID2=FOODPULSEDATA(8,2);
FOODPER2=FOODPULSEDATA(9,2);

%Other data files
INOTHERDATA=INPUTDATA(461:511,2:21);
OTHERPULSEDATA=INPUTDATA(513:532,2:21);

%Other data arrays
INOTHER=[INOTHERDATA(2:51,7),INOTHERDATA(2:51,3)];
INOTHERBASE=OTHERPULSEDATA(1,2);
INOTHERPULSE=OTHERPULSEDATA(2,2);
FOTHERPULSE=OTHERPULSEDATA(3,2);
OTHERSTART=OTHERPULSEDATA(4,2);
OTHERSTOP=OTHERPULSEDATA(5,2);
OTHERWID1=OTHERPULSEDATA(6,2);
OTHERPER1=OTHERPULSEDATA(7,2);
OTHERWID2=OTHERPULSEDATA(8,2);
OTHERPER2=OTHERPULSEDATA(9,2);

%RBA data files
AF1DATA=INPUTDATA(534:553,2:21);
RBADATA=INPUTDATA(555:574,2:21);

%RBA data arrays
AF1=[AF1DATA(1:20,4),AF1DATA(1:20,3)];
RBAET2GI=RBADATA(1,2);
RBADUST=RBADATA(2,2);
RBAWATER=RBADATA(3,2);
RBAFOOD=RBADATA(4,2);
RBAOTHER=RBADATA(5,2);

%Lung data files
FMSDATA=INPUTDATA(576:595,2:21);
RTKINDATA=INPUTDATA(597:616,2:21);
RTPSDATA=INPUTDATA(618,2:21);
RTDEPDATA=INPUTDATA(620:749,2:21);

%Lung data arrays
%Absorption
PISPTS=FMSDATA(1,2);
PISBL=FMSDATA(2,2);
PISBL=FMSDATA(3,2);
BNDBL=FMSDATA(4,2);
FBND=FMSDATA(5,2);

%Compartmental kinetics
ET1EXH=RTKINDATA(1,2);
ET2GI=RTKINDATA(2,2);
ET3ETLN=RTKINDATA(3,2);
BB1ET2=RTKINDATA(4,2);
BB2ET2=RTKINDATA(5,2);
BB3THLN=RTKINDATA(6,2);
BBO1BB1=RTKINDATA(7,2);
BBO2BB1=RTKINDATA(8,2);
BBO3THLN=RTKINDATA(9,2);
AI1BBO1=RTKINDATA(10,2);
AI2BBO1=RTKINDATA(11,2);
AI3BBO1=RTKINDATA(12,2);
AI3THLN=RTKINDATA(13,2);

%Particle size
PSRN=RTPSDATA(1,1);

%Depostion fractions
FET1=[RTDEPDATA(PSRN+0,4:12),RTDEPDATA(2,4:12)];	
FET2=[RTDEPDATA(PSRN+1,4:12),RTDEPDATA(2,4:12)];
FET3=[RTDEPDATA(PSRN+2,4:12),RTDEPDATA(2,4:12)];
FBB1=[RTDEPDATA(PSRN+3,4:12),RTDEPDATA(2,4:12)];
FBB2=[RTDEPDATA(PSRN+4,4:12),RTDEPDATA(2,4:12)];
FBB3=[RTDEPDATA(PSRN+5,4:12),RTDEPDATA(2,4:12)];
FBBO1=[RTDEPDATA(PSRN+6,4:12),RTDEPDATA(2,4:12)];
FBBO2=[RTDEPDATA(PSRN+7,4:12),RTDEPDATA(2,4:12)];
FBBO3=[RTDEPDATA(PSRN+8,4:12),RTDEPDATA(2,4:12)];
FAI1=[RTDEPDATA(PSRN+9,4:12),RTDEPDATA(2,4:12)];
FAI2=[RTDEPDATA(PSRN+10,4:12),RTDEPDATA(2,4:12)];
FAI3=[RTDEPDATA(PSRN+11,4:12),RTDEPDATA(2,4:12)];

%Systemic data files
SYSKINCDATA=INPUTDATA(751:830,2:21);
SYSKINADATA=INPUTDATA(832:911,2:21);

%Systemic data constants
ASHWT=SYSKINCDATA(1,2);
BLDMOT=SYSKINCDATA(2,2);
BONIN=SYSKINCDATA(3,2);
BRANIN=SYSKINCDATA(4,2);
BRATIO=SYSKINCDATA(5,2);
CRTWT=SYSKINCDATA(6,2);
H1TOBL=SYSKINCDATA(7,2);
H1TOH2=SYSKINCDATA(8,2);
H1TOSI=SYSKINCDATA(9,2);
HEPIN=SYSKINCDATA(10,2);
IFETAL=SYSKINCDATA(11,2);
KWT=SYSKINCDATA(12,2);
PLSVOL=SYSKINCDATA(13,2);
POWER=SYSKINCDATA(14,2);
RBCIN=SYSKINCDATA(15,2);
RBCNL=SYSKINCDATA(16,2);
RBCVOL=SYSKINCDATA(17,2);
RENIN=SYSKINCDATA(18,2);
RKDN1=SYSKINCDATA(19,2);
RLLI=SYSKINCDATA(20,2);
RLVR1=SYSKINCDATA(21,2);
RPLAS=SYSKINCDATA(22,2);
RPROT=SYSKINCDATA(23,2);
RSIC=SYSKINCDATA(24,2);
RSOF0=SYSKINCDATA(25,2);
RSOF1=SYSKINCDATA(26,2);
RSOF2=SYSKINCDATA(27,2);
RSTMC=SYSKINCDATA(28,2);
RULI=SYSKINCDATA(29,2);
S2HAIR=SYSKINCDATA(30,2);
SATRAT=SYSKINCDATA(31,2);
SIZEVF=SYSKINCDATA(32,2);
SOFIN=SYSKINCDATA(33,2);
TBONEL=SYSKINCDATA(34,2);
TEVF=SYSKINCDATA(35,2);
TOFECE=SYSKINCDATA(36,2);
TOKDN1=SYSKINCDATA(37,2);
TOKDN2=SYSKINCDATA(38,2);
TOLVR1=SYSKINCDATA(39,2);
TOPROT=SYSKINCDATA(40,2);
TORBC=SYSKINCDATA(41,2);
TOSWET=SYSKINCDATA(42,2);
TOURIN=SYSKINCDATA(43,2);
TRBWT=SYSKINCDATA(44,2);
VBLC=SYSKINCDATA(45,2);
VKC=SYSKINCDATA(46,2);
VLC=SYSKINCDATA(47,2);
VLUC=SYSKINCDATA(48,2);

%Systemic data arrays
AMTBLD=[SYSKINADATA(3,2:12),SYSKINADATA(2,2:12)];
FLONG=[SYSKINADATA(4,2:12),SYSKINADATA(2,2:12)];
GSCAL=[SYSKINADATA(5,2:12),SYSKINADATA(2,2:12)];
RBLAD=[SYSKINADATA(6,2:12),SYSKINADATA(2,2:12)];
RBRAN=[SYSKINADATA(7,2:12),SYSKINADATA(2,2:12)];
RCORT=[SYSKINADATA(8,2:12),SYSKINADATA(2,2:12)];
RCS2B=[SYSKINADATA(9,2:12),SYSKINADATA(2,2:12)];
RCS2DF=[SYSKINADATA(10,2:12),SYSKINADATA(2,2:12)];
RDIFF=[SYSKINADATA(11,2:12),SYSKINADATA(2,2:12)];
RKDN2=[SYSKINADATA(12,2:12),SYSKINADATA(2,2:12)];
RLVR2=[SYSKINADATA(13,2:12),SYSKINADATA(2,2:12)];
RRBC=[SYSKINADATA(14,2:12),SYSKINADATA(2,2:12)];
RTRAB=[SYSKINADATA(15,2:12),SYSKINADATA(2,2:12)];
RTS2B=[SYSKINADATA(16,2:12),SYSKINADATA(2,2:12)];
RTS2DF=[SYSKINADATA(17,2:12),SYSKINADATA(2,2:12)];
TBONE=[SYSKINADATA(18,2:12),SYSKINADATA(2,2:12)];
TFRAC=[SYSKINADATA(19,2:12),SYSKINADATA(2,2:12)];
TOBRAN=[SYSKINADATA(20,2:12),SYSKINADATA(2,2:12)];
TOSOF0=[SYSKINADATA(21,2:12),SYSKINADATA(2,2:12)];
TOSOF1=[SYSKINADATA(22,2:12),SYSKINADATA(2,2:12)];
TOSOF2=[SYSKINADATA(23,2:12),SYSKINADATA(2,2:12)];

%Sex data files
SEXDATA=INPUTDATA(913:932,2:21);

%Gender data constants
WBIRTH=SEXDATA(1,2);
WCHILD=SEXDATA(2,2);
HALF=SEXDATA(3,2);
WADULT=SEXDATA(4,2);
KAPPA=SEXDATA(5,2);
LAMBDA=SEXDATA(6,2);
LB=SEXDATA(7,2);
HCTA=SEXDATA(8,2);



