%--------------------------------------------------------------------
%
% File: AALM_OF_IN.m
%
% Created by Gary Diamond, SRC Inc, 09/15/14
%
%This run time file:
%	Reads inputs from INPUTDATA.DATA derived from AALM-OF INPUT&OUTPUT.xls
%	Populates TABLE variables in AALM_OF.csl; e.g., CAIR=[CAIRDATA(2:51,10),CAIRDATA(2:51,3)]
%	Sets constants in AALM_OF.csl; e.g., CAIRBASE=AIRPULSEDATA(1,2)
% --------------------------------------------------------------------

load @file=AALM_OF_INPUTDATA @format=ascii 

INPUTDATA=AALM_OF_INPUTDATA;

%Simulation parameters
SIMDATA=INPUTDATA (2:11, 2:21);

%End day of simulation (d)
TSTOP=SIMDATA(1,1);

%Communication interval (d)	
CINT=SIMDATA(2,1);	

%Data files

%Air data files
CAIRDATA=INPUTDATA(13:63, 2:21);
AIRPULSEDATA=INPUTDATA(65:84,2:21);
VENTDATA=INPUTDATA(86:136,2:21);

%Air data arrays
CAIR=[CAIRDATA(2:51,10),CAIRDATA(2:51,2)];
VENT=[VENTDATA(1:50,4),VENTDATA(1:50,2)];
CAIRBASE=AIRPULSEDATA(1,3);
CAIRPULSE=AIRPULSEDATA(2,3);
FAIRPULSE=AIRPULSEDATA(3,3);
AIRSTART=AIRPULSEDATA(4,3);
AIRSTOP=AIRPULSEDATA(5,3);
AIRWID1=AIRPULSEDATA(6,3);
AIRPER1=AIRPULSEDATA(7,3);
AIRWID2=AIRPULSEDATA(8,3);
AIRPER2=AIRPULSEDATA(9,3);

%Dust data files
CDUSTDATA=INPUTDATA(138:188,2:21);
DUSTPULSEDATA=INPUTDATA(190:209,2:21);
IRDUSTDATA=INPUTDATA(211:261,2:21);

%Dust data arrays
CDUST=[CDUSTDATA(2:51,10),CDUSTDATA(2:51,2)];
IRDUST=[IRDUSTDATA(1:50,4),IRDUSTDATA(1:50,2)];
CDUSTBASE=DUSTPULSEDATA(1,3);
CDUSTPULSE=DUSTPULSEDATA(2,3);
FDUSTPULSE=DUSTPULSEDATA(3,3);
DUSTSTART=DUSTPULSEDATA(4,3);
DUSTSTOP=DUSTPULSEDATA(5,3);
DUSTWID1=DUSTPULSEDATA(6,3);
DUSTPER1=DUSTPULSEDATA(7,3);
DUSTWID2=DUSTPULSEDATA(8,3);
DUSTPER2=DUSTPULSEDATA(9,3);

%Water data files
CWATERDATA=INPUTDATA(263:313,2:21);
WATERPULSEDATA=INPUTDATA(315:334,2:21);
IRWATERDATA=INPUTDATA(336:386,2:21);

%Water data arrays
CWATER=[CWATERDATA(2:51,10),CWATERDATA(2:51,2)];
IRWATER=[IRWATERDATA(1:50,4),IRWATERDATA(1:50,2)];
CWATERBASE=WATERPULSEDATA(1,3);
CWATERPULSE=WATERPULSEDATA(2,3);
FWATERPULSE=WATERPULSEDATA(3,3);
WATERSTART=WATERPULSEDATA(4,3);
WATERSTOP=WATERPULSEDATA(5,3);
WATERWID1=WATERPULSEDATA(6,3);
WATERPER1=WATERPULSEDATA(7,3);
WATERWID2=WATERPULSEDATA(8,3);
WATERPER2=WATERPULSEDATA(9,3);

%Food data files
INFOODDATA=INPUTDATA(338:438,2:21);
FOODPULSEDATA=INPUTDATA(440:459,2:21);

%Food data arrays
INFOOD=[INFOODDATA(2:51,7),INFOODDATA(2:51,2)];
INFOODBASE=FOODPULSEDATA(1,3);
INFOODPULSE=FOODPULSEDATA(2,3);
FFOODPULSE=FOODPULSEDATA(3,3);
FOODSTART=FOODPULSEDATA(4,3);
FOODSTOP=FOODPULSEDATA(5,3);
FOODWID1=FOODPULSEDATA(6,3);
FOODPER1=FOODPULSEDATA(7,3);
FOODWID2=FOODPULSEDATA(8,3);
FOODPER2=FOODPULSEDATA(9,3);

%Other data files
INOTHERDATA=INPUTDATA(461:511,2:21);
OTHERPULSEDATA=INPUTDATA(513:532,2:21);

%Other data arrays
INOTHER=[INOTHERDATA(2:51,7),INOTHERDATA(2:51,2)];
INOTHERBASE=OTHERPULSEDATA(1,3);
INOTHERPULSE=OTHERPULSEDATA(2,3);
FOTHERPULSE=OTHERPULSEDATA(3,3);
OTHERSTART=OTHERPULSEDATA(4,3);
OTHERSTOP=OTHERPULSEDATA(5,3);
OTHERWID1=OTHERPULSEDATA(6,3);
OTHERPER1=OTHERPULSEDATA(7,3);
OTHERWID2=OTHERPULSEDATA(8,3);
OTHERPER2=OTHERPULSEDATA(9,3);

%RBA data files
AF1DATA=INPUTDATA(534:553,2:21);
RBADATA=INPUTDATA(555:574,2:21);

%RBA data arrays
AF1=[AF1DATA(1:20,4),AF1DATA(1:20,2)];
RBAAIR=RBADATA(1,2);
RBADUST=RBADATA(2,2);
RBAWATER=RBADATA(3,2);
RBAFOOD=RBADATA(4,2);
RBAOTHER=RBADATA(5,2);


%Lung data files
FMSDATA=INPUTDATA(576:595,2:21);
RTKINDATA=INPUTDATA(597:616,2:21);
RTPSDATA=INPUTDATA(618,2:21);
RTDEPDATA=INPUTDATA(620:749,2:21);

%Lung data arrays
%Absorption
PISPTS=FMSDATA(1,2);
PISBL=FMSDATA(2,2);
PISBL=FMSDATA(3,2);
BNDBL=FMSDATA(4,2);
FBND=FMSDATA(5,2);

%Compartmental kinetics
ET1EXH=RTKINDATA(1,3);
ET2GI=RTKINDATA(2,3);
ET3ETLN=RTKINDATA(3,3);
BB1ET2=RTKINDATA(4,3);
BB2ET2=RTKINDATA(5,3);
BB3THLN=RTKINDATA(6,3);
BBO1BB1=RTKINDATA(7,3);
BBO2BB1=RTKINDATA(8,3);
BBO3THLN=RTKINDATA(9,3);
AI1BBO1=RTKINDATA(10,3);
AI2BBO1=RTKINDATA(11,3);
AI3BBO1=RTKINDATA(12,3);
AI3THLN=RTKINDATA(13,3);

%Particle size
PSRN=RTPSDATA(1,1);

%Depostion fractions
FET1=[RTDEPDATA(PSRN+0,4:12),RTDEPDATA(2,4:12)];	
FET2=[RTDEPDATA(PSRN+1,4:12),RTDEPDATA(2,4:12)];
FET3=[RTDEPDATA(PSRN+2,4:12),RTDEPDATA(2,4:12)];
FBB1=[RTDEPDATA(PSRN+3,4:12),RTDEPDATA(2,4:12)];
FBB2=[RTDEPDATA(PSRN+4,4:12),RTDEPDATA(2,4:12)];
FBB3=[RTDEPDATA(PSRN+5,4:12),RTDEPDATA(2,4:12)];
FBBO1=[RTDEPDATA(PSRN+6,4:12),RTDEPDATA(2,4:12)];
FBBO2=[RTDEPDATA(PSRN+7,4:12),RTDEPDATA(2,4:12)];
FBBO3=[RTDEPDATA(PSRN+8,4:12),RTDEPDATA(2,4:12)];
FAI1=[RTDEPDATA(PSRN+9,4:12),RTDEPDATA(2,4:12)];
FAI2=[RTDEPDATA(PSRN+10,4:12),RTDEPDATA(2,4:12)];
FAI3=[RTDEPDATA(PSRN+11,4:12),RTDEPDATA(2,4:12)];


%Systemic data files
SYSKINCDATA=INPUTDATA(751:830,2:21);
SYSKINADATA=INPUTDATA(832:911,2:21);

%Systemic data constants
A1=SYSKINCDATA(1,2);
A2=SYSKINCDATA(2,2);
A3=SYSKINCDATA(3,2);
A5=SYSKINCDATA(4,2);
AGE0=SYSKINCDATA(5,2);
BASE=SYSKINCDATA(6,2);
BIND=SYSKINCDATA(7,2);
BINDC1=SYSKINCDATA(8,2);
BINDC2=SYSKINCDATA(9,2);
BINDC3=SYSKINCDATA(10,2);
C1=SYSKINCDATA(11,2);
C2=SYSKINCDATA(12,2);
C3=SYSKINCDATA(13,2);
CON=SYSKINCDATA(14,2);
D0=SYSKINCDATA(15,2);
EXPO=SYSKINCDATA(16,2);
G=SYSKINCDATA(17,2);
KBIND=SYSKINCDATA(18,2);
KBINDC1=SYSKINCDATA(19,2);
KBINDC2=SYSKINCDATA(20,2);
KBINDC3=SYSKINCDATA(21,2);
P0=SYSKINCDATA(22,2);
PKAGE=SYSKINCDATA(23,2);
PKZ=SYSKINCDATA(24,2);
PLAGE=SYSKINCDATA(25,2);
PLZ=SYSKINCDATA(26,2);
PP=SYSKINCDATA(27,2);
PWAGE=SYSKINCDATA(28,2);
PWZ=SYSKINCDATA(29,2);
QBONEC=SYSKINCDATA(30,2);
QCC=SYSKINCDATA(31,2);
QKC=SYSKINCDATA(32,2);
QLC=SYSKINCDATA(33,2);
QWC=SYSKINCDATA(34,2);
R0=SYSKINCDATA(35,2);
RAD1=SYSKINCDATA(36,2);
RAD2=SYSKINCDATA(37,2);
RAD3=SYSKINCDATA(38,2);
RAD4=SYSKINCDATA(39,2);
RAD5=SYSKINCDATA(40,2);
RAD6=SYSKINCDATA(41,2);
RAD7=SYSKINCDATA(42,2);
RAD8=SYSKINCDATA(43,2);
S=SYSKINCDATA(44,2);
VBLC=SYSKINCDATA(45,2);
VBLWPC=SYSKINCDATA(46,2);
VKC=SYSKINCDATA(47,2);
VLC=SYSKINCDATA(48,2);
VWC=SYSKINCDATA(49,2);
MATBLD=SYSKINCDATA(50,2);
VBLZ=SYSKINCDATA(51,2);
FEMATBL=SYSKINCDATA(52,2);
FABLZ=SYSKINCDATA(53,2);
FAKZ=SYSKINCDATA(54,2);
FALZ=SYSKINCDATA(55,2);
FABZ=SYSKINCDATA(56,2);
FAOZ=SYSKINCDATA(57,2);




%Gender data files
GENDERDATA=INPUTDATA(913:932,2:21);

%Gender data constants
WBIRTH=GENDERDATA(1,2);
WCHILD=GENDERDATA(2,2);
HALF=GENDERDATA(3,2);
WADULT=GENDERDATA(4,2);
KAPPA=GENDERDATA(5,2);
LAMBDA=GENDERDATA(6,2);
LB=GENDERDATA(7,2);
AGEA=GENDERDATA(8,2);
CUTOFF=GENDERDATA(9,2);
P0=GENDERDATA(10,2);
LEAD=GENDERDATA(11,2);
HCTA=GENDERDATA(12,2);